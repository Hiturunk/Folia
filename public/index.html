<!doctype html>
  <head>
    <script>
    var key = 'demo';
    var portfolio = [];
    var tools = ["addFinancialAccountPlanner().account_balance","removeAccount().work_off","inputStockAPIKEY().youtube_searched_for","renderAccountTable().history","resetPortfolio().power_settings_new","addBrokerageAccount().add_box"]
    var plannerOpen=0;
      function incomeChecker(){
        var inc = 0;
        for(i=0;i<portfolio.length;i++){
          inc+=portfolio[i].projectedMonthlyIncome();
        }
        return inc;
      }
      function inputStockAPIKEY(){
        var stockAPIKEY = prompt("Please Enter your API key for stock data..","demo");
        key == stockAPIKEY;
      }
      function simpleInterest(x,apy){
        return x*apy;
      }
      function Portfolio(accounts){
        this.accounts = accounts;
      }
      function FinancialAccount(name,institution,balance,apy){
      this.name = name;
      this.institution = institution;
      this.balance = balance;
      this.apy = apy;
      this.projectedMonthlyIncome = function(){
        return this.balance*this.apy/12;
      }
      function BrokerageAccount(name,institution,balance,assets){
        this.name = name;
        this.institution = institution;
        this.balance = balance;
        this.assets = assets;
        //We will pass an array of assets to the brokerageAccount constructor in the future..
        this.projectedMonthlyIncome = function(){
          var a = 0;
          for(i=0;i<this.assets.length;i++){
            a += this.assets[i].projectedMonthlyIncome();
          }
          return a;
        }
      }
      function asset(name,price,quantity,dividend,dividendsPerYear){
        this.name = name;
        this.price = price;
        this.dividend = dividend;
        this.dividendsPerYear = dividendsPerYear
        this.livePrice = function(){
          //future live price function
          //No longer the future!
          this.price = getQuote(this.name);
        }
        this.projectedMonthlyIncome = function(){
          var yearly = this.dividend*this.dividendsPerYear;
          var monthly = yearly/12;
          return monthly;
        }
      }
    }
      function salary(amt){
        this.monthly = amt/12;
        this.yearly = amt;
      }
      function getQuote(ticker,key){
        //Using an API to import a quote..
        var quote = "";
        var requestURL = 'https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol='+ticker+'&apikey='+key+'';
        var request = new XMLHttpRequest();
          request.open('GET', requestURL);
          request.responseType='json';
          request.onload=function(){
            var data = this.response;
            if(this.readyState==4&&this.status==200){
                console.log(data["Global Quote"]["01. symbol"])
                console.log(data["Global Quote"]["05. price"]);
                console.log(data);
                return data["Global Quote"]["05. price"];
              }
            }
        request.send();
      }
      function resetPortfolio(){
                var dare = prompt("ARE YOU SURE!? Y=1,N=0","0");
                if(dare==1){portfolio=[];renderAccountTable()}
      }
      function parseQuote(ticker,key){
      }
      function renderToolBar(){
        var toolbar = document.createElement("tr");
        toolbar.id="toolbar";
        for(i=0;i<tools.length;i++){
          var spl = tools[i].split('.');
          var a = document.createElement("i");
          a.setAttribute("onclick",spl[0]);
          a.setAttribute("class","material-icons md-60");
          a.innerHTML=spl[1];
          toolbar.appendChild(a);
        }
        document.body.appendChild(toolbar);
      }
      function renderAccountTable(){
        var target = document.getElementById("accountTable");
        if(target){target.parentElement.removeChild(target);}
        var folia = portfolio;
        var tableEl = document.createElement("div");
        tableEl.id="accountTable";
        var incomeText=document.createTextNode("Income Per Month:");
        var income = document.createTextNode(incomeChecker());
        tableEl.appendChild(incomeText);
        tableEl.appendChild(income);
        for(i=0;i<=portfolio.length;i++){
          var accountEl = document.createElement("div");
          if(portfolio[i]){
          accountEl.innerHTML=JSON.stringify(portfolio[i]);
          tableEl.appendChild(accountEl);
        }
        }
        document.body.appendChild(tableEl);
      }
      function addFinAccount(){
        var a = document.getElementById("finAcctPlanner_Name").value;
        var b = document.getElementById("finAcctPlanner_Institution").value;
        var c = document.getElementById("finAcctPlanner_Balance").value;
        var d = document.getElementById("finAcctPlanner_Apy").value;
        var obj = new FinancialAccount(a,b,c,d);
        portfolio.push(obj);
        renderAccountTable();
      }
      function addFinancialAccountPlanner(){
        if(plannerOpen==1){
          plannerOpen=0;
          var a = document.getElementById("finAcctPlanner");
          a.parentElement.removeChild(a);
        }
        else{
        plannerOpen=1;
        var obj = document.createElement("div");
        obj.id="finAcctPlanner";
        obj.appendChild(document.createTextNode("Enter the Name, Institution, Balance, and APY of your new account.."));
        var nameObj=document.createElement("td");
        var nameText=document.createTextNode("Name:");
        var name = document.createElement("textarea");
        name.id="finAcctPlanner_Name";
        nameObj.appendChild(nameText);
        nameObj.appendChild(name);
        var instObj = document.createElement("td");
        var institutionText=document.createTextNode("Bank:");
        var institution = document.createElement("textarea");
        institution.id="finAcctPlanner_Institution";
        instObj.appendChild(institutionText);
        instObj.appendChild(institution);
        var balObj = document.createElement("td");
        var balanceText=document.createTextNode("Balance");
        var balance = document.createElement("textarea");
        balance.id="finAcctPlanner_Balance";
        balObj.appendChild(balanceText);
        balObj.appendChild(balance);
        var apyObj=document.createElement("td");
        var apyText=document.createTextNode("APY:");
        var apy = document.createElement("textarea");
        apy.id="finAcctPlanner_Apy"
        apyObj.appendChild(apyText);
        apyObj.appendChild(apy);
        var button = document.createElement("i");
        button.setAttribute('onclick','addFinAccount()');
        button.setAttribute('class',"material-icons md-60");
        button.innerHTML="star_rate";
        obj.appendChild(nameObj);
        obj.appendChild(instObj);
        obj.appendChild(balObj);
        obj.appendChild(apyObj);
        obj.appendChild(button);
        document.body.appendChild(obj);
        }
      }
      function addBrokerageAccount(){
        //Will Render a planner
      }
    </script>
    <style>
      i{
        height:1em;
        width:1em;
      }
      #toolbar{
        border-width:medium;
        border-style:inset;
        border-color:black;
        background-color:#9999FF;
      }
      .material-icons.md-60 { font-size: 60px; }
      #finAcctPlanner{
        background-color:gold;
        border-width:thin;
        border-color:black;
        border-style: ridge;
      }
    </style>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
  </head>
  <body onload="renderToolBar()">
  </body>
</html>
